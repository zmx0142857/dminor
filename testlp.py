#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from lp import LP, le, ge, eq
from matrix import rMat
"""
mat = rMat([\
    [1, 2, 0, 1, 0, 100],\
    [0, 0, 2, 2, 1, 100],\
    [3, 1, 2, 0, 3, 100]])
chk = [0, 0.1, 0.2, 0.3, 0.8]
lp_obj = LP(mat, chk, maximum=False)
print(lp_obj.solve(True))
"""
"""
solve lp:
min 0.1x2 + 0.2x3 + 0.3x4 + 0.8x5
s.t.
    x1 + 2x2 + x4 = 100
    2x3 + 2x4 + x5 = 100
    3x1 + x2 + 2x3 + 3x5 = 100
    all xi >= 0
add slack or artificial variable:
min 0.1x2 + 0.2x3 + 0.3x4 + 0.8x5
s.t.
    x1 + 2x2 + x4 + x6 = 100
    2x3 + 2x4 + x5 + x7 = 100
    3x1 + x2 + 2x3 + 3x5 + x8 = 100
    all xi >= 0
base: [6, 7, 8]
step 1:
solve lp:
min x6 + x7 + x8
s.t.
    x1 + 2x2 + x4 + x6 = 100
    2x3 + 2x4 + x5 + x7 = 100
    3x1 + x2 + 2x3 + 3x5 + x8 = 100
    all xi >= 0
base: [6, 7, 8]
simplex table:
  1   2   0   1   0   1   0   0 100
  0   0   2   2   1   0   1   0 100
  3   1   2   0   3   0   0   1 100
  0   0   0   0   0   1   1   1   0
eliminate check numbers for base:
   1    2    0    1    0    1    0    0  100
   0    0    2    2    1    0    1    0  100
   3    1    2    0    3    0    0    1  100
  -4   -3   -4   -3   -4    0    0    0 -300
iteration #1:
     0    5/3   -2/3      1     -1      1      0   -1/3  200/3
     0      0      2      2      1      0      1      0    100
     1    1/3    2/3      0      1      0      0    1/3  100/3
     0   -5/3   -4/3     -3      0      0      0    4/3 -500/3
base: [6, 7, 1]
iteration #2:
   0    1 -2/5  3/5 -3/5  3/5    0 -1/5   40
   0    0    2    2    1    0    1    0  100
   1    0  4/5 -1/5  6/5 -1/5    0  2/5   20
   0    0   -2   -2   -1    1    0    1 -100
base: [2, 7, 1]
iteration #3:
 1/2    1    0  1/2    0  1/2    0    0   50
-5/2    0    0  5/2   -2  1/2    1   -1   50
 5/4    0    1 -1/4  3/2 -1/4    0  1/2   25
 5/2    0    0 -5/2    2  1/2    0    2  -50
base: [2, 7, 3]
iteration #4:
    1     1     0     0   2/5   2/5  -1/5   1/5    40
   -1     0     0     1  -4/5   1/5   2/5  -2/5    20
    1     0     1     0 13/10  -1/5  1/10   2/5    30
    0     0     0     0     0     1     1     1     0
base: [2, 4, 3]
('optimal solution', [0, 40, 30, 20, 0, 0, 0, 0], 0)
step 2:
simplex table:
    1     1     0     0   2/5    40
   -1     0     0     1  -4/5    20
    1     0     1     0 13/10    30
    0   0.1   0.2   0.3   0.8     0
eliminate check numbers for base:
    1     1     0     0   2/5    40
   -1     0     0     1  -4/5    20
    1     0     1     0 13/10    30
    0     0     0     0 37/50   -16
('optimal solution', [0, 40, 30, 20, 0], 16)
"""
"""
mat = rMat([\
    [-0.5, 0.5, 0.5, 0, 0, 0, 0, 0, 0, 0],\
    [-0.25, 0.75, -0.25, 0, 0, 0, 0, 0, 0, 0],\
    [0, 0, 0, -0.75, 0.25, 0.25, 0, 0, 0, 0],\
    [0, 0, 0, -0.5, 0.5, -0.5, 0, 0, 0, 0],\
    [1, 0, 0, 1, 0, 0, 1, 0, 0, 100],\
    [0, 1, 0, 0, 1, 0, 0, 1, 0, 100],\
    [0, 0, 1, 0, 0, 1, 0, 0, 1, 60]])
chk = [-15, 25, 15, -30, 10, 0, -40, 0, -10]
rel = [le for i in range(7)]
lp_obj = LP(mat, chk, relation=rel)
print(lp_obj.solve(True))
"""
"""
solve lp:
max -15x1 + 25x2 + 15x3 - 30x4 + 10x5 - 40x7 - 10x9
s.t.
    -0.5x1 + 0.5x2 + 0.5x3 <= 0
    -0.25x1 + 0.75x2 - 0.25x3 <= 0
    -0.75x4 + 0.25x5 + 0.25x6 <= 0
    -0.5x4 + 0.5x5 - 0.5x6 <= 0
    x1 + x4 + x7 <= 100
    x2 + x5 + x8 <= 100
    x3 + x6 + x9 <= 60
    all xi >= 0
add slack or artificial variable:
max -15x1 + 25x2 + 15x3 - 30x4 + 10x5 - 40x7 - 10x9
s.t.
    -0.5x1 + 0.5x2 + 0.5x3 + x10 <= 0
    -0.25x1 + 0.75x2 - 0.25x3 + x11 <= 0
    -0.75x4 + 0.25x5 + 0.25x6 + x12 <= 0
    -0.5x4 + 0.5x5 - 0.5x6 + x13 <= 0
    x1 + x4 + x7 + x14 <= 100
    x2 + x5 + x8 + x15 <= 100
    x3 + x6 + x9 + x16 <= 60
    all xi >= 0
base: [10, 11, 12, 13, 14, 15, 16]
step 1:
solve lp:
min 
s.t.
    -0.5x1 + 0.5x2 + 0.5x3 + x10 = 0
    -0.25x1 + 0.75x2 - 0.25x3 + x11 = 0
    -0.75x4 + 0.25x5 + 0.25x6 + x12 = 0
    -0.5x4 + 0.5x5 - 0.5x6 + x13 = 0
    x1 + x4 + x7 + x14 = 100
    x2 + x5 + x8 + x15 = 100
    x3 + x6 + x9 + x16 = 60
    all xi >= 0
base: [10, 11, 12, 13, 14, 15, 16]
simplex table:
 -0.5   0.5   0.5     0     0     0     0     0     0     1     0     0     0     0     0     0     0
-0.25  0.75 -0.25     0     0     0     0     0     0     0     1     0     0     0     0     0     0
    0     0     0 -0.75  0.25  0.25     0     0     0     0     0     1     0     0     0     0     0
    0     0     0  -0.5   0.5  -0.5     0     0     0     0     0     0     1     0     0     0     0
    1     0     0     1     0     0     1     0     0     0     0     0     0     1     0     0   100
    0     1     0     0     1     0     0     1     0     0     0     0     0     0     1     0   100
    0     0     1     0     0     1     0     0     1     0     0     0     0     0     0     1    60
    0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
eliminate check numbers for base:
 -0.5   0.5   0.5     0     0     0     0     0     0     1     0     0     0     0     0     0     0
-0.25  0.75 -0.25     0     0     0     0     0     0     0     1     0     0     0     0     0     0
    0     0     0 -0.75  0.25  0.25     0     0     0     0     0     1     0     0     0     0     0
    0     0     0  -0.5   0.5  -0.5     0     0     0     0     0     0     1     0     0     0     0
    1     0     0     1     0     0     1     0     0     0     0     0     0     1     0     0   100
    0     1     0     0     1     0     0     1     0     0     0     0     0     0     1     0   100
    0     0     1     0     0     1     0     0     1     0     0     0     0     0     0     1    60
    0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
('optimal solution', [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 100, 60], 0)
step 2:
simplex table:
 -0.5   0.5   0.5     0     0     0     0     0     0     1     0     0     0     0     0     0     0
-0.25  0.75 -0.25     0     0     0     0     0     0     0     1     0     0     0     0     0     0
    0     0     0 -0.75  0.25  0.25     0     0     0     0     0     1     0     0     0     0     0
    0     0     0  -0.5   0.5  -0.5     0     0     0     0     0     0     1     0     0     0     0
    1     0     0     1     0     0     1     0     0     0     0     0     0     1     0     0   100
    0     1     0     0     1     0     0     1     0     0     0     0     0     0     1     0   100
    0     0     1     0     0     1     0     0     1     0     0     0     0     0     0     1    60
  -15    25    15   -30    10     0   -40     0   -10     0     0     0     0     0     0     0     0
eliminate check numbers for base:
 -0.5   0.5   0.5     0     0     0     0     0     0     1     0     0     0     0     0     0     0
-0.25  0.75 -0.25     0     0     0     0     0     0     0     1     0     0     0     0     0     0
    0     0     0 -0.75  0.25  0.25     0     0     0     0     0     1     0     0     0     0     0
    0     0     0  -0.5   0.5  -0.5     0     0     0     0     0     0     1     0     0     0     0
    1     0     0     1     0     0     1     0     0     0     0     0     0     1     0     0   100
    0     1     0     0     1     0     0     1     0     0     0     0     0     0     1     0   100
    0     0     1     0     0     1     0     0     1     0     0     0     0     0     0     1    60
  -15    25    15   -30    10     0   -40     0   -10     0     0     0     0     0     0     0     0
iteration #1:
   -1     1     1     0     0     0     0     0     0     2     0     0     0     0     0     0     0
  1/2     0    -1     0     0     0     0     0     0  -3/2     1     0     0     0     0     0     0
    0     0     0 -0.75  0.25  0.25     0     0     0     0     0     1     0     0     0     0     0
    0     0     0  -0.5   0.5  -0.5     0     0     0     0     0     0     1     0     0     0     0
    1     0     0     1     0     0     1     0     0     0     0     0     0     1     0     0   100
    1     0    -1     0     1     0     0     1     0    -2     0     0     0     0     1     0   100
    0     0     1     0     0     1     0     0     1     0     0     0     0     0     0     1    60
   10     0   -10   -30    10     0   -40     0   -10   -50     0     0     0     0     0     0     0
base: [2, 11, 12, 13, 14, 15, 16]
iteration #2:
    0     1    -1     0     0     0     0     0     0    -1     2     0     0     0     0     0     0
    1     0    -2     0     0     0     0     0     0    -3     2     0     0     0     0     0     0
    0     0     0 -0.75  0.25  0.25     0     0     0     0     0     1     0     0     0     0     0
    0     0     0  -0.5   0.5  -0.5     0     0     0     0     0     0     1     0     0     0     0
    0     0     2     1     0     0     1     0     0     3    -2     0     0     1     0     0   100
    0     0     1     0     1     0     0     1     0     1    -2     0     0     0     1     0   100
    0     0     1     0     0     1     0     0     1     0     0     0     0     0     0     1    60
    0     0    10   -30    10     0   -40     0   -10   -20   -20     0     0     0     0     0     0
base: [2, 1, 12, 13, 14, 15, 16]
iteration #3:
    0     1     0   1/2     0     0   1/2     0     0   1/2     1     0     0   1/2     0     0    50
    1     0     0     1     0     0     1     0     0     0     0     0     0     1     0     0   100
    0     0     0 -0.75  0.25  0.25     0     0     0     0     0     1     0     0     0     0     0
    0     0     0  -0.5   0.5  -0.5     0     0     0     0     0     0     1     0     0     0     0
    0     0     1   1/2     0     0   1/2     0     0   3/2    -1     0     0   1/2     0     0    50
    0     0     0  -1/2     1     0  -1/2     1     0  -1/2    -1     0     0  -1/2     1     0    50
    0     0     0  -1/2     0     1  -1/2     0     1  -3/2     1     0     0  -1/2     0     1    10
    0     0     0   -35    10     0   -45     0   -10   -35   -10     0     0    -5     0     0  -500
base: [2, 1, 12, 13, 3, 15, 16]
iteration #4:
   0    1    0  1/2    0    0  1/2    0    0  1/2    1    0    0  1/2    0    0   50
   1    0    0    1    0    0    1    0    0    0    0    0    0    1    0    0  100
   0    0    0   -3    1    1    0    0    0    0    0    4    0    0    0    0    0
   0    0    0    1    0   -1    0    0    0    0    0   -2    1    0    0    0    0
   0    0    1  1/2    0    0  1/2    0    0  3/2   -1    0    0  1/2    0    0   50
   0    0    0  5/2    0   -1 -1/2    1    0 -1/2   -1   -4    0 -1/2    1    0   50
   0    0    0 -1/2    0    1 -1/2    0    1 -3/2    1    0    0 -1/2    0    1   10
   0    0    0   -5    0  -10  -45    0  -10  -35  -10  -40    0   -5    0    0 -500
base: [2, 1, 5, 13, 3, 15, 16]
('optimal solution', [100, 50, 50, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50, 10], 500)
"""
